# 项目结构说明

## 📁 目录结构

```
md2doc/                          # 项目根目录
├── src/                          # 源代码目录
│   └── md2doc/                   # 核心包
│       ├── __init__.py           # 包初始化
│       ├── cli.py                # 命令行工具
│       ├── config.py             # 配置管理
│       └── converter.py          # 转换器核心（含格式化和解析）
│
├── tests/                        # 测试目录
│   └── test_converter.py         # 单元测试
│
├── docs/                         # 文档目录
│   ├── guide/                    # 使用指南
│   │   ├── 快速开始.md
│   │   ├── 虚拟环境使用指南.md
│   │   ├── 环境配置.md
│   │   ├── pip安装说明.md
│   │   └── pip安装位置总结.md
│   ├── reference/                # 参考文档
│   │   ├── 完整格式规范.md
│   │   ├── 新版格式规范说明.md
│   │   ├── 字体格式说明.md
│   │   └── 问题修复说明.md
│   ├── history/                  # 历史记录
│   │   ├── 第二次修复说明.md
│   │   ├── 横线移除说明.md
│   │   ├── 落款右对齐说明.md
│   │   └── 首行缩进修复说明.md
│   ├── 项目结构说明.md
│   └── 项目优化总结.md
│
├── input/                        # 输入文件夹
│   ├── 测试文档.md
│   └── 示例.md
│
├── output/                       # 输出文件夹
│   └── (生成的Word文档)
│
├── venv/                         # 虚拟环境（已在.gitignore中）
│
├── 运行.bat                       # Windows便捷脚本
├── 运行测试.bat                   # 测试脚本
│
├── md2doc.py                     # 主程序入口
│
├── README.md                     # 项目说明
├── requirements.txt              # 依赖列表
└── .gitignore                    # Git忽略文件
```

## 📦 核心模块说明

### 1. **config.py** - 配置管理
管理所有格式规范和常量：
- 字体配置（名称、大小、粗体）
- 页边距配置
- 段落配置（行距、缩进）

### 2. **converter.py** - 转换器核心
统一的转换模块，包含：
- **格式化工具函数**：字体设置、段落格式、页边距
- **解析工具函数**：行内格式解析、标题提取、文件名清理
- **转换器类**：文档转换、内容处理、各元素处理

### 3. **cli.py** - 命令行工具
提供命令行接口：
- 批量转换
- 单文件转换
- 日志记录
- 参数处理

## 🚀 使用方式

### Windows用户
```bash
# 方式1：双击运行（最简单）
运行.bat

# 方式2：命令行
venv\Scripts\activate
python md2doc.py
```

### Linux/Mac用户
```bash
source venv/bin/activate
python md2doc.py
```

## 📝 文档说明

### 使用指南（guide/）
- **快速开始.md** - 5分钟上手指南
- **虚拟环境使用指南.md** - 虚拟环境详解
- **环境配置.md** - 环境配置说明
- **pip安装说明.md** - pip安装详解
- **pip安装位置总结.md** - 快速参考

### 参考文档（reference/）
- **完整格式规范.md** - 完整格式参考
- **新版格式规范说明.md** - 详细格式说明
- **字体格式说明.md** - 字体使用说明
- **问题修复说明.md** - 常见问题

### 历史记录（history/）
- 记录项目的迭代历史
- 每次修复的详细说明
- 版本变更记录

## 🧪 测试

运行单元测试：
```bash
python tests/test_converter.py
```

或使用便捷脚本：
```bash
运行测试.bat
```

## ⚙️ 配置说明

### 当前格式规范

| 项目 | 设置 |
|------|------|
| **正文行距** | 固定值 28pt |
| **正文字体** | 仿宋_GB2312 |
| **正文字号** | 3号 (16pt) |
| **首行缩进** | 2字符 (0.3英寸) |
| **页边距** | 上3.7cm, 下3.5cm, 左2.8cm, 右2.6cm |

### 修改配置

如需自定义格式，编辑 `src/md2doc/config.py` 中的配置。

## 🎯 项目特点

1. **模块化设计** - 清晰的职责划分
2. **虚拟环境** - 隔离依赖，不影响其他项目
3. **便捷脚本** - Windows一键运行
4. **完整文档** - 详细的使用说明和参考文档
5. **单元测试** - 确保代码质量

## 📦 依赖关系

```
python-docx (1.2.0)
    └── lxml (6.0.2)
        └── typing_extensions
```

## 🔧 开发说明

### 添加新功能
1. 在对应模块中添加功能
2. 更新测试
3. 更新文档

### 代码规范
- 遵循PEP 8
- 使用类型提示
- 添加文档字符串

## 📄 许可证

MIT License
