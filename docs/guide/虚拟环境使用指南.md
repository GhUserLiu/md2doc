# 虚拟环境使用指南

## 什么是虚拟环境？

虚拟环境是 Python 项目的独立环境，每个项目有自己的一套包，互不影响。

## 为什么使用虚拟环境？

✅ **隔离性**：不同项目的包不会相互冲突
✅ **依赖管理**：每个项目有独立的依赖版本
✅ **干净整洁**：不污染全局 Python 环境
✅ **易于清理**：删除项目文件夹即可完全清理

## 本项目已配置虚拟环境

本项目已经创建了虚拟环境并安装了所有依赖！

### 虚拟环境位置

```
md2doc/
└── venv/                    # 虚拟环境目录
    ├── Lib/
    │   └── site-packages/   # 包安装位置
    ├── Scripts/             # 可执行文件（Windows）
    │   ├── python.exe       # 虚拟环境的Python
    │   ├── pip.exe          # 虚拟环境的pip
    │   └── activate.bat     # 激活脚本
    └── ...
```

### 已安装的包

- ✅ python-docx 1.2.0
- ✅ lxml 6.0.2
- ✅ typing_extensions 4.15.0

## 使用方法

### Windows 用户

#### 方法1：使用便捷脚本（推荐）

**双击运行以下批处理文件：**

1. `运行.bat` - 转换 Markdown 文件
2. `运行测试.bat` - 运行单元测试
3. `激活虚拟环境.bat` - 激活虚拟环境进入命令行

#### 方法2：命令行手动操作

```bash
# 1. 激活虚拟环境
venv\Scripts\activate

# 激活后，命令行前面会显示 (venv)
# (venv) C:\Users\liuzh\Projects\Workspace\md2doc>

# 2. 运行项目
python md2doc.py

# 3. 运行测试
python tests\test_converter.py

# 4. 使用完毕，退出虚拟环境
deactivate
```

### Linux/Mac 用户

```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 运行项目
python md2doc.py

# 3. 运行测试
python tests/test_converter.py

# 4. 退出虚拟环境
deactivate
```

## 验证虚拟环境

### 检查 Python 路径

激活虚拟环境后，运行：

```bash
# Windows
where python

# Linux/Mac
which python
```

**正确输出**（指向项目内的虚拟环境）：
```
C:\Users\liuzh\Projects\Workspace\md2doc\venv\Scripts\python.exe
```

**错误输出**（指向全局Python，说明未激活虚拟环境）：
```
C:\Users\liuzh\miniconda3\python.exe
```

### 检查已安装的包

```bash
pip list
```

应该看到：
```
python-docx            1.2.0
lxml                   6.0.2
pip                    25.2
setuptools             75.8.0
typing_extensions      4.15.0
```

## 常见问题

### Q1: 我需要重新创建虚拟环境吗？

**不需要**！虚拟环境已经创建好了，直接使用即可。

如果需要重新创建：
```bash
# Windows
rmdir /s /q venv
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt

# Linux/Mac
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### Q2: 如何在虚拟环境中安装新的包？

```bash
# 先激活虚拟环境
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# 安装包
pip install package-name

# 更新 requirements.txt
pip freeze > requirements.txt
```

### Q3: 虚拟环境占用多少空间？

大约 50-100 MB，主要来自复制 Python 解释器和依赖包。

### Q4: 我可以删除虚拟环境吗？

可以！直接删除 `venv` 文件夹即可：
```bash
# Windows
rmdir /s /q venv

# Linux/Mac
rm -rf venv
```

删除后可以重新创建，不会影响项目。

### Q5: Git 会提交虚拟环境吗？

**不会**！`.gitignore` 文件已配置忽略 `venv/` 目录。

## 依赖管理

### 查看当前依赖

```bash
pip list
```

### 导出依赖列表

```bash
pip freeze > requirements.txt
```

### 从 requirements.txt 安装

```bash
pip install -r requirements.txt
```

## 最佳实践

1. **总是使用虚拟环境**
   - 不要在全局环境安装项目依赖

2. **激活虚拟环境后再操作**
   - 运行项目、测试、安装包前先激活

3. **保持 requirements.txt 更新**
   - 安装新包后更新 requirements.txt

4. **不要提交虚拟环境到 Git**
   - 虚拟环境已在 .gitignore 中

5. **为每个项目创建独立虚拟环境**
   - 避免不同项目的依赖冲突

## 对比：虚拟环境 vs 全局环境

| 特性 | 虚拟环境 | 全局环境 |
|------|---------|---------|
| 隔离性 | ✅ 完全隔离 | ❌ 混在一起 |
| 依赖管理 | ✅ 独立管理 | ❌ 难以管理 |
| 冲突风险 | ✅ 无冲突 | ❌ 容易冲突 |
| 清理 | ✅ 删除文件夹即可 | ❌ 需要手动卸载 |
| 推荐度 | ⭐⭐⭐⭐⭐ | ⭐ |

## 总结

✅ 本项目已配置好虚拟环境
✅ 双击 `运行.bat` 即可使用
✅ 虚拟环境确保依赖隔离
✅ 不会影响其他项目

**推荐使用方式**：双击 `运行.bat` 即可！
