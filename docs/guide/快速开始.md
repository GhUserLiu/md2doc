# 快速开始指南

## 5分钟上手 md2doc

### 步骤1：安装依赖

```bash
# 安装依赖
pip install -r requirements.txt

# 或者使用虚拟环境（推荐）
python -m venv venv

# Windows激活
venv\Scripts\activate

# Linux/Mac激活
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

### 步骤2：准备Markdown文件

将Markdown文件放入`input/`文件夹。

示例文件结构：

```
input/
├── 我的文档.md
└── 另一个文档.md
```

### 步骤3：运行转换

```bash
# 方法1：使用启动脚本（推荐）
python md2doc.py

# 方法2：使用旧版工具
python convert.py
```

### 步骤4：查看结果

转换后的Word文档保存在`output/`文件夹。

```
output/
├── 我的文档.docx
└── 另一个文档.docx
```

## 常用命令

### 批量转换

```bash
# 转换input文件夹中的所有md文件
python md2doc.py

# 指定输入输出目录
python md2doc.py -i ./md_files -o ./word_files
```

### 单文件转换

```bash
# 转换单个文件
python md2doc.py -f document.md
```

### 查看详细日志

```bash
# 显示详细信息
python md2doc.py -v

# 保存日志到文件
python md2doc.py -l conversion.log
```

## Markdown示例

创建一个测试文件 `test.md`：

```markdown
# 文档标题

这是一段正文，首行自动缩进2字符。

## 二级标题

正文内容继续。

### 三级标题

- 列表项1
- 列表项2

> 这是引用块

**加粗文本** 和 *斜体文本*

落款：张三
日期：2026年1月5日
```

运行转换：

```bash
python md2doc.py -f test.md
```

## 格式特点

转换后的Word文档自动具有以下特点：

✅ **标题**：方正小标宋简体，2号，居中
✅ **二级标题**：黑体，3号，左对齐
✅ **三级标题**：楷体，3号，左对齐
✅ **正文**：仿宋_GB2312，3号，首行缩进2字符
✅ **行距**：固定值28磅
✅ **页边距**：符合公文规范
✅ **落款**：自动右对齐

## 作为Python库使用

```python
from pathlib import Path
from md2doc import MarkdownConverter

# 创建转换器
converter = MarkdownConverter()

# 转换文件
md_file = Path('input/document.md')
doc, title = converter.convert(md_file)

# 保存文档
doc.save(f'output/{title}.docx')
```

## 自定义配置

```python
from md2doc import MarkdownConverter
from md2doc.config import ConverterConfig
from docx.shared import Pt

# 创建自定义配置
config = ConverterConfig()

# 修改正文字体
config.FONTS['body'].name = '宋体'
config.FONTS['body'].size = Pt(14)

# 使用自定义配置
converter = MarkdownConverter(config=config)
```

## 故障排除

### 问题1：找不到字体

确保系统已安装所需字体：
- 方正小标宋简体
- 黑体
- 楷体
- 仿宋_GB2312

### 问题2：编码错误

确保Markdown文件使用UTF-8编码保存。

### 问题3：模块导入错误

确保已正确设置路径或使用启动脚本：

```bash
python md2doc.py  # 推荐
```

## 下一步

- 查看 [README.md](../README.md) 了解完整功能
- 查看 [新版格式规范说明.md](./新版格式规范说明.md) 了解详细格式
- 查看 [项目结构说明.md](./项目结构说明.md) 了解项目架构
- 查看 [input/测试文档.md](../input/测试文档.md) 查看完整示例

## 需要帮助？

- 运行 `python md2doc.py -h` 查看帮助
- 查看 [docs/](./) 目录中的详细文档
- 提交Issue报告问题
